<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SS Weight Calculator</title>
    <link rel="manifest" href="manifest.json">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue@3.2.47"></script>
    <style>
        body {
            background-color: #f8f9fa;
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 500px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        .shape-option, .material-option {
            font-size: 1.2rem;
            cursor: pointer;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            flex: 1;
            border: 2px solid transparent;
        }
        .shape-option.active, .material-option.active {
            border-color: #007bff;
            background: #007bff;
            color: white;
        }
        .btn-lg {
            font-size: 1.25rem;
            padding: 12px;
            width: 100%;
            border-radius: 10px;
        }
        #installApp {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container mt-4" id="app">
        <h2 class="text-center">Stainless Steel Weight Calculator</h2>

        <div class="mt-3">
            <label class="form-label">Select Shape</label>
            <div class="d-flex gap-2">
                <div @click="shape = 'rod'" class="shape-option" :class="{active: shape === 'rod'}">
                    <i class="fas fa-circle"></i> Rod
                </div>
                <div @click="shape = 'tube'" class="shape-option" :class="{active: shape === 'tube'}">
                    <i class="far fa-circle"></i> Tube
                </div>
                <div @click="shape = 'square_pipe'" class="shape-option" :class="{active: shape === 'square_pipe'}">
                    <i class="far fa-square"></i> Square Pipe
                </div>
                <div @click="shape = 'rect'" class="shape-option" :class="{active: shape === 'rect'}">
                    <i class="fas fa-cube"></i> 
                    Rect Bar
                </div>
            </div>
        </div>

        <div class="mt-3">
            <label class="form-label">Select Material</label>
            <div class="d-flex gap-2">
                <div @click="material = 'ss304'" class="material-option" :class="{active: material === 'ss304'}">SS304</div>
                <div @click="material = 'ss316'" class="material-option" :class="{active: material === 'ss316'}">SS316</div>
            </div>
        </div>

        <div class="mt-3" v-if="shape !== ''">
            <label class="form-label">Enter Dimensions (mm)</label>
            <input v-if="shape === 'rod'" type="number" class="form-control" v-model.number="diameter" placeholder="Diameter">
            <div v-if="shape === 'tube'" class="d-flex gap-2">
                <input type="number" class="form-control" v-model.number="outerDiameter" placeholder="Outer Diameter">
                <input type="number" class="form-control" v-model.number="thickness" placeholder="Wall Thickness">
            </div>
            <div v-if="shape === 'square_pipe'" class="d-flex gap-2">
                <input type="number" class="form-control" v-model.number="width" placeholder="Width">
                <input type="number" class="form-control" v-model.number="thikness" placeholder="Wall Thickness">
            </div>
            <div v-if="shape === 'rect'" class="d-flex gap-2">
                <input type="number" class="form-control" v-model.number="width" placeholder="Width">
                <input type="number" class="form-control" v-model.number="height" placeholder="Height">
            </div>
            <input type="number" class="form-control mt-2" v-model.number="length" placeholder="Length">
        </div>
        <div class="mt-3 text-center" v-if="weight !== null">
            <h4>Estimated Weight: {{ weight.toFixed(2) }} kg</h4>
        </div>
        <div class="text-center mt-4" v-if="weight !== null">
            <!-- <p><strong>Details:</strong></p> -->
            <p><span>{{ material.toUpperCase() }}</span> | <span>{{ shape.charAt(0).toUpperCase() + shape.slice(1) }}</span></p>
            <p>
                <span v-if="shape === 'rod'">Ã˜: {{ diameter }} mm</span>
                <span v-if="shape === 'tube'">OD: {{ outerDiameter }} mm | Thickness: {{ thickness }} mm</span>
                <span v-if="shape === 'rect'">Width: {{ width }} mm | Height: {{ height }} mm</span>
                | Length: {{ length }} mm
            </p>
        </div>
        <div class="text-center">
            <button class="btn btn-success btn-md mt-3" @click="calculateWeight">Calculate Weight</button>
        </div>


        <button id="installApp" class="btn btn-success btn-lg mt-3" onclick="installPWA()">Download App</button>
    </div>

    <script>
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installApp').style.display = 'block';
        });
        function installPWA() {
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then(() => {
                document.getElementById('installApp').style.display = 'none';
            });
        }

        const app = Vue.createApp({
            data() {
                return {
                    shape: 'rod',
                    material: 'ss304',
                    diameter: null,
                    outerDiameter: null,
                    thickness: null,
                    width: null,
                    height: null,
                    length: null,
                    weight: null
                };
            },
            computed: {
                density() {
                    return this.material === 'ss304' ? 8000 : 7980;
                }
            },
            watch: {
                material() {
                    this.calculateWeight(); // Live calculation when material changes
                },
                shape() {
                    this.weight = null; // Reset weight when shape changes
                },
                diameter() {
                    this.calculateWeight(); // Live calculation when diameter changes
                },
                outerDiameter() {
                    this.calculateWeight(); // Live calculation when outer diameter changes
                },
                thickness() {
                    this.calculateWeight(); // Live calculation when wall thickness changes
                },
                width() {
                    this.calculateWeight(); // Live calculation when width changes
                },
                height() {
                    this.calculateWeight(); // Live calculation when height changes
                },
                length() {
                    this.calculateWeight(); // Live calculation when length changes
                }
            },
            methods: {
                calculateWeight() {
                    let volume = 0;
                    if (this.shape === 'rod' && this.diameter && this.length) {
                        let radius = this.diameter / 2 / 1000;
                        volume = Math.PI * Math.pow(radius, 2) * (this.length / 1000); // Volume in m^3
                    } else if (this.shape === 'tube' && this.outerDiameter && this.thickness && this.length) {
                        let outerRadius = this.outerDiameter / 2 / 1000;
                        let innerRadius = (this.outerDiameter - 2 * this.thickness) / 2 / 1000;
                        volume = Math.PI * (Math.pow(outerRadius, 2) - Math.pow(innerRadius, 2)) * (this.length / 1000); // Volume in m^3
                    } else if (this.shape === 'rect' && this.width && this.height && this.length) {
                        volume = (this.width / 1000) * (this.height / 1000) * (this.length / 1000); // Volume in m^3
                    } else if (this.shape === 'square_pipe' && this.width && this.thickness && this.length) {
                        let outerArea = (this.width / 1000) ** 2; 
                        let innerWidth = this.width - 2 * this.thickness;
                        let innerArea = (innerWidth / 1000) ** 2;
                        volume = (outerArea - innerArea) * (this.length / 1000);
                    }

                    this.weight =  volume * this.density; // Weight in kg
                    if (this.weight <=0 ) {
                        this.weight = null;
                    }
                }
            }
        });
        app.mount('#app');
    </script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(() => console.log("Service Worker Registered"));
        }
    </script>
    
</body>
</html>
